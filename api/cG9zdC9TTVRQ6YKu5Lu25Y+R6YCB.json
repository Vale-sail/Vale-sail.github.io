{"title":"SMTP邮件发送文件名乱码问题","date":"2021-12-14T02:25:00.000Z","author":"Vale Sail","slug":"SMTP邮件发送","categories":["l"],"updated":"2021-12-14T03:33:18.183Z","content":"<h3 id=\"背景\">背景<a href=\"post/SMTP邮件发送#背景\"></a></h3><p>公司工资条使用go写的一个小程序发送工资条邮件，小程序里面使用 gomail.v2组件来进行发送，直接发送是，foxmail收到的邮件附件里面文件名会乱码，但是网页版能够正常展示</p>\n<h3 id=\"解决方式\">解决方式<a href=\"post/SMTP邮件发送#解决方式\"></a></h3><p>将邮件内容使用base64进行编码，base64编码的之后的字符都是7为ASCII字符，服务端只需要按照base64解码出来就能取到正常的文本内容</p>\n<h3 id=\"可能原因\">可能原因<a href=\"post/SMTP邮件发送#可能原因\"></a></h3><h4 id=\"smtp协议\">smtp协议<a href=\"post/SMTP邮件发送#smtp协议\"></a></h4><p>SMTP协议报文都使用7位ASCII码格式，如果报文包含了非7位ASCII字符或者二进制数据，如图形文件，则该报文必须按照7位ASCII码进行编码。由于文件名是中文的，7位的ASCII码无法标示，所以会出现乱码</p>\n<h4 id=\"为什么网页正常\">为什么网页正常<a href=\"post/SMTP邮件发送#为什么网页正常\"></a></h4><p>gomail.v2，在不指定编码时，base64编码默认指定使用RFC 2047里面的Q-encoding 进行编码数据，浏览器应该做了支持，Foxmail 对RFC 2047 的 Q-encoding 没有进行支持，无法正常解析。Foxmail的base64 只是支持了RFC 2045。所以指定为BEncoding 时，浏览器和Foxmail都能过正常支持</p>\n","next":{"title":"关键字","slug":"关键字"},"link":"https://vale-sail.github.io/post/SMTP邮件发送/"}